<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pm2+api</title>
    <link rel="stylesheet" href="./pm2+api.css">
    <script src="./pm2+api.js"></script>
</head>
<body>
    <div class="box">
        <div class="center">
            <h1>使用PM2搭建后端api接口</h1>
            <div class="content">
                <li><strong>PM2_MySQL</strong></li>
                <div class="column">
                    <span>步骤一：进入服务器并 cd 到 /etc/www 目录下</span>
                    <span>步骤二：输入以下命令进入数据库并输入密码登陆</span>
                    <div class="Board">
                        <div class="BoardHead">
                            <!-- onclick="cope('document.getElementById(`txt`)')" 复制id为txt的内容 -->
                            <button onclick="copyToClipboard('txtone')">
                                <svg t="1757132891560" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4577" width="15" height="15"><path d="M731.68184 676.057473 731.68184 183.323259c0-30.233582-24.512277-54.745858-54.747905-54.745858L184.216093 128.577401c-30.233582 0-54.746882 24.512277-54.746882 54.745858l0 492.734214c0 30.207999 24.5133 54.746882 54.746882 54.746882l492.717841 0C707.16854 730.804355 731.68184 706.265472 731.68184 676.057473zM622.1891 676.057473 238.962975 676.057473c-30.233582 0-54.746882-24.538883-54.746882-54.745858L184.216093 238.07014c0-30.233582 24.5133-54.746882 54.746882-54.746882l383.226125 0c30.233582 0 54.744835 24.512277 54.744835 54.746882l0 383.242498C676.933935 651.51859 652.421658 676.057473 622.1891 676.057473zM841.17458 292.817022l-54.745858 0 0 54.746882c30.232558 0 54.745858 24.5133 54.745858 54.759161l0 383.228171c0 30.206976-24.5133 54.745858-54.745858 54.745858L403.201573 840.297095c-30.233582 0-54.746882-24.538883-54.746882-54.745858l-54.746882 0 0 54.745858c0 30.207999 24.5133 54.747905 54.746882 54.747905l492.719888 0c30.234605 0 54.747905-24.539906 54.747905-54.747905L895.922485 347.563904C895.922485 317.329299 871.408161 292.817022 841.17458 292.817022z" p-id="4578"></path></svg>
                            </button>
                        </div>
                        <div class="BoardText">
                            <span id="txtone">sudo mysql -u root -p</span>
                        </div>
                    </div>
                    <span>步骤三：创建数据表 userinfo</span>
                    <div class="Board">
                        <div class="BoardHead">
                            <!-- onclick="cope('document.getElementById(`txt`)')" 复制id为txt的内容 -->
                            <button onclick="copyToClipboard('txttwo')">
                                <svg t="1757132891560" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4577" width="15" height="15"><path d="M731.68184 676.057473 731.68184 183.323259c0-30.233582-24.512277-54.745858-54.747905-54.745858L184.216093 128.577401c-30.233582 0-54.746882 24.512277-54.746882 54.745858l0 492.734214c0 30.207999 24.5133 54.746882 54.746882 54.746882l492.717841 0C707.16854 730.804355 731.68184 706.265472 731.68184 676.057473zM622.1891 676.057473 238.962975 676.057473c-30.233582 0-54.746882-24.538883-54.746882-54.745858L184.216093 238.07014c0-30.233582 24.5133-54.746882 54.746882-54.746882l383.226125 0c30.233582 0 54.744835 24.512277 54.744835 54.746882l0 383.242498C676.933935 651.51859 652.421658 676.057473 622.1891 676.057473zM841.17458 292.817022l-54.745858 0 0 54.746882c30.232558 0 54.745858 24.5133 54.745858 54.759161l0 383.228171c0 30.206976-24.5133 54.745858-54.745858 54.745858L403.201573 840.297095c-30.233582 0-54.746882-24.538883-54.746882-54.745858l-54.746882 0 0 54.745858c0 30.207999 24.5133 54.747905 54.746882 54.747905l492.719888 0c30.234605 0 54.747905-24.539906 54.747905-54.747905L895.922485 347.563904C895.922485 317.329299 871.408161 292.817022 841.17458 292.817022z" p-id="4578"></path></svg>
                            </button>
                        </div>
                        <div class="BoardText">
                            <span id="txttwo">
                                CREATE TABLE userinfo (<br>
                                    &emsp;id char(20) NOT NULL,<br>
                                    &emsp;username varchar(40) NOT NULL,<br>
                                    &emsp;password varchar(40) NOT NULL,<br>
                                    &emsp;PRIMARY KEY (id)<br>
                                ) ENGINE=InnoDB DEFAULT CHARSET=gb2312;
                            </span>
                        </div>
                    </div>
                    <span>步骤四：往数据表中插入数据</span>
                    <div class="Board">
                        <div class="BoardHead">
                            <!-- onclick="cope('document.getElementById(`txt`)')" 复制id为txt的内容 -->
                            <button onclick="copyToClipboard('txtthree')">
                                <svg t="1757132891560" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4577" width="15" height="15"><path d="M731.68184 676.057473 731.68184 183.323259c0-30.233582-24.512277-54.745858-54.747905-54.745858L184.216093 128.577401c-30.233582 0-54.746882 24.512277-54.746882 54.745858l0 492.734214c0 30.207999 24.5133 54.746882 54.746882 54.746882l492.717841 0C707.16854 730.804355 731.68184 706.265472 731.68184 676.057473zM622.1891 676.057473 238.962975 676.057473c-30.233582 0-54.746882-24.538883-54.746882-54.745858L184.216093 238.07014c0-30.233582 24.5133-54.746882 54.746882-54.746882l383.226125 0c30.233582 0 54.744835 24.512277 54.744835 54.746882l0 383.242498C676.933935 651.51859 652.421658 676.057473 622.1891 676.057473zM841.17458 292.817022l-54.745858 0 0 54.746882c30.232558 0 54.745858 24.5133 54.745858 54.759161l0 383.228171c0 30.206976-24.5133 54.745858-54.745858 54.745858L403.201573 840.297095c-30.233582 0-54.746882-24.538883-54.746882-54.745858l-54.746882 0 0 54.745858c0 30.207999 24.5133 54.747905 54.746882 54.747905l492.719888 0c30.234605 0 54.747905-24.539906 54.747905-54.747905L895.922485 347.563904C895.922485 317.329299 871.408161 292.817022 841.17458 292.817022z" p-id="4578"></path></svg>
                            </button>
                        </div>
                        <div class="BoardText">
                            <span id="txtthree">
                                USER userinfo;<br>
                                INSER TINTO userinfo values('1','admin','123456'),('10','mysql','123456');
                            </span>
                        </div>
                    </div>
                    <span>步骤五：输入<code>quit</code>保存退出</span>
                    <span>步骤六：进入WinTerm。在/etc/www目录下创建一个 MyClassroom_server.js文件（MyClassroom_server.js内容如下）</span>
                    <div class="Board">
                        <div class="BoardHead">
                            <!-- onclick="cope('document.getElementById(`txt`)')" 复制id为txt的内容 -->
                            <button onclick="copyToClipboard('txtfour')">
                                <svg t="1757132891560" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4577" width="15" height="15"><path d="M731.68184 676.057473 731.68184 183.323259c0-30.233582-24.512277-54.745858-54.747905-54.745858L184.216093 128.577401c-30.233582 0-54.746882 24.512277-54.746882 54.745858l0 492.734214c0 30.207999 24.5133 54.746882 54.746882 54.746882l492.717841 0C707.16854 730.804355 731.68184 706.265472 731.68184 676.057473zM622.1891 676.057473 238.962975 676.057473c-30.233582 0-54.746882-24.538883-54.746882-54.745858L184.216093 238.07014c0-30.233582 24.5133-54.746882 54.746882-54.746882l383.226125 0c30.233582 0 54.744835 24.512277 54.744835 54.746882l0 383.242498C676.933935 651.51859 652.421658 676.057473 622.1891 676.057473zM841.17458 292.817022l-54.745858 0 0 54.746882c30.232558 0 54.745858 24.5133 54.745858 54.759161l0 383.228171c0 30.206976-24.5133 54.745858-54.745858 54.745858L403.201573 840.297095c-30.233582 0-54.746882-24.538883-54.746882-54.745858l-54.746882 0 0 54.745858c0 30.207999 24.5133 54.747905 54.746882 54.747905l492.719888 0c30.234605 0 54.747905-24.539906 54.747905-54.747905L895.922485 347.563904C895.922485 317.329299 871.408161 292.817022 841.17458 292.817022z" p-id="4578"></path></svg>
                            </button>
                        </div>
                        <div class="BoardText">
                            <span id="txtfour">
                                const express = require('express');<br>
                                const mysql = require('mysql2/promise');<br>
                                const cors = require('cors');<br>

                                const app = express();<br>
                                app.use(cors());<br>
                                app.use(express.json());<br>

                                // ? 连接你的 MariaDB 数据库<br>
                                const pool = mysql.createPool({<br>
                                    &emsp;host: '127.0.0.1',<br>
                                    &emsp;user: 'vueuser',// 数据库登陆账号<br>
                                    &emsp;password: '123456',// 数据库密码<br>
                                    &emsp;database: 'vue2Mysql'// ? 数据表<br>
                                });<br>
                                // 示例路由。如果请求成功后直接访问 http://localhost:3001/ 就可以看到请求过来的数据<br>
                                app.get('/', async (req, res) => {<br>
                                    &emsp;try {<br>
                                        &emsp;&emsp;// userinfo<br>
                                        &emsp;&emsp;const [userinfo] = await pool.query('SELECT * FROM userinfo');<br>
                                        &emsp;&emsp;// myclassroom <br>
                                        &emsp;&emsp;const [myclassroom] = await pool.query('SELECT * FROM myclassroom');<br>
                                        &emsp;&emsp;// windows_server <br>
                                        &emsp;&emsp;const [windows_server] = await pool.query('SELECT * FROM windows_server');<br>
                                        &emsp;&emsp;// nat_server <br>
                                        &emsp;&emsp;const [routing_switching] = await pool.query('SELECT * FROM routing_switching');<br>
                                        &emsp;&emsp;// python_programming <br>
                                        &emsp;&emsp;const [python_programming] = await pool.query('SELECT * FROM python_programming');<br>
                                        &emsp;&emsp;// MyTextbook <br>
                                        &emsp;&emsp;const [mytextbook] = await pool.query('SELECT * FROM mytextbook');<br>
                                        &emsp;&emsp;// MyExam <br>
                                        &emsp;&emsp;const [myexam] = await pool.query('SELECT * FROM myexam');<br>
                                        
                                        &emsp;&emsp;res.json({<br>
                                            &emsp;&emsp;&emsp;userinfo,<br>
                                            &emsp;&emsp;&emsp;myclassroom,<br>
                                            &emsp;&emsp;&emsp;windows_server,<br>
                                            &emsp;&emsp;&emsp;routing_switching,<br>
                                            &emsp;&emsp;&emsp;python_programming,<br>
                                            &emsp;&emsp;&emsp;mytextbook,<br>
                                            &emsp;&emsp;&emsp;myexam <br>
                                        &emsp;&emsp;});<br>
                                    &emsp;} catch (err) {<br>
                                        &emsp;&emsp;console.error('服务器错误:', err);<br>
                                        &emsp;&emsp;res.status(500).json({ error: 'Internal Server Error' });<br>
                                        &emsp;} <br>
                                });<br>
                                // ? 监听 0.0.0.0，开放给公网访问<br>
                                app.listen(3001, '0.0.0.0', () => {<br>
                                    &emsp;console.log('Server running on http://0.0.0.0:3001');<br>
                                });
                            </span>
                        </div>
                    </div>
                    <span>步骤七：编辑完成后保存退出</span>
                    <span>步骤八：输入以下命令使用PM2搭建后端api接口</span>
                    <div class="Board">
                        <div class="BoardHead">
                            <!-- onclick="cope('document.getElementById(`txt`)')" 复制id为txt的内容 -->
                            <button onclick="copyToClipboard('txtfive')">
                                <svg t="1757132891560" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4577" width="15" height="15"><path d="M731.68184 676.057473 731.68184 183.323259c0-30.233582-24.512277-54.745858-54.747905-54.745858L184.216093 128.577401c-30.233582 0-54.746882 24.512277-54.746882 54.745858l0 492.734214c0 30.207999 24.5133 54.746882 54.746882 54.746882l492.717841 0C707.16854 730.804355 731.68184 706.265472 731.68184 676.057473zM622.1891 676.057473 238.962975 676.057473c-30.233582 0-54.746882-24.538883-54.746882-54.745858L184.216093 238.07014c0-30.233582 24.5133-54.746882 54.746882-54.746882l383.226125 0c30.233582 0 54.744835 24.512277 54.744835 54.746882l0 383.242498C676.933935 651.51859 652.421658 676.057473 622.1891 676.057473zM841.17458 292.817022l-54.745858 0 0 54.746882c30.232558 0 54.745858 24.5133 54.745858 54.759161l0 383.228171c0 30.206976-24.5133 54.745858-54.745858 54.745858L403.201573 840.297095c-30.233582 0-54.746882-24.538883-54.746882-54.745858l-54.746882 0 0 54.745858c0 30.207999 24.5133 54.747905 54.746882 54.747905l492.719888 0c30.234605 0 54.747905-24.539906 54.747905-54.747905L895.922485 347.563904C895.922485 317.329299 871.408161 292.817022 841.17458 292.817022z" p-id="4578"></path></svg>
                            </button>
                        </div>
                        <div class="BoardText">
                            <span id="txtfive">pm2 start MyClassroom_server.js --name MyClassroom_server_api</span>
                        </div>
                    </div>
                    <span>最后：你的api接口已经搭建好了。您可以在浏览器中通过以下地址访问您的后端数据了：<code>http://[您的服务器IP]:3001</code></span>
                </div>
            </div>
            <!--  -->
            <div class="content">
                <li><strong>PM2_JSON</strong></li>
                <div class="column">
                    持续更新中...
                </div>
            </div>
        </div>
    </div>
</body>
</html>
